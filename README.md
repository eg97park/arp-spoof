# arp-spoof
BoB 11기 이경문 멘토님 과제입니다.

## send-arp 기존 과제 재구현 관련
1. send-arp 과제에서 직접 어설프게 만들었던 구조체 사용을 버리고, 주어진 헤더에 명시된 것들을 적극적으로 사용했습니다.
2. 기존 pcap_nonblock 싱글스레드 방식에서 멀티스레드 방식으로 작동하도록 재구현하였으나, 아직 굳이 멀티스레드로 만든 메리트가 드러나도록 효율적으로 구현하지는 못한 상태입니다.

## Changelog
* 2022-08-21 21:04 기준 ARP Spoofing, Relay 2가지 기능에 대해서 작동만 하는 코드이므로, 고칠 부분이 많습니다.
* 2022-08-22 04:38 기준 기존 기능에 SIGINT 감지 + ARP Table Recovery 기능을 추가하였습니다.
* 2022-08-22 17:36 기준 기존 기능에 특정 타이밍(ARP 복구 시도)에 재감염하는 기능, 점보 프레임 예외 기능을 추가했습니다.

## TODO
* 점보프레임 관련: 현재 점보프레임을 릴레이 시, 주어진 패킷의 길이가 너무 길다는 내용의 에러가 발생하는데 처리하도록 구현해보기.
* 성능 관련 개선사항: 내부 비교 시, 무거운? 자료형 사용하지 말고 uint32_t 혹은 memcmp 등을 사용하기.
* 스레드 관련 개선사항 생각해보기.
* Sender -> Me, Target -> Me, 즉 정상적으로 나한테 보내는 패킷들은 릴레이할 필요가 없는데, 하나?


## 점보프레임 관련
Fragmentation => UDP, ICMP / 1개 죽으면 다 놓침.
eth ip  tcp data1
eth ip  data2
eth ip  dat3

Segmentation => TCP
eth ip  tcp data1
eth ip  tcp data2
eth ip  tcp data3

## SIGTERM?
signal?

## free 효율적으로 하는 방법
현재 프로그램 종료 파트 다 찾아서 비효율적으로 하는 중.

## cpp를 사용할 수 있다면 사용하기.
생성자 적극적으로 사용하기. -> 알아서 소멸되어서 free 자동 해결.. 아마??

## 성능 관련
자료형 비교는 간단하게. 출력을 복잡하게.
포인터 복사 vs 데이터 copy.
Flow로 묶어서 한번에 처리하기.
malloc 1번 -> free 1번. valgrind 꼭 사용하기.
pcap_open_live 3번째 인자: 타이밍 될 때까지 패킷 모아놓음. 이 다음에 next_ex() 호출됨. 여기서는 짧게 해야 함.

## 디자인 관련
쓸데없는 코드 삭제. 재사용.

## 패킷 가끔 씹히는 경우
WiFi 절전 모드 등. 보통 3번째 보내줌. 화면 꺼져있을 때 등등의 상황에서 작동함.

## 좀 더 정밀한 필터링 필요.
...

